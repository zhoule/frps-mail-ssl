# FRPS + Mail + SSL ç³»ç»Ÿæ¶æ„å›¾

## ğŸ—ï¸ æ•´ä½“æ¶æ„å›¾

```
                                    Internet
                                       â”‚
                                       â”‚ Port 80/443
                                       â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                               Nginx Proxy                                   â”‚
â”‚                           (SSL Termination)                                â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                             â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”              â”‚
â”‚  â”‚   Let's Encrypt â”‚  â”‚  SSL Certs      â”‚  â”‚  Domain Config  â”‚              â”‚
â”‚  â”‚   Auto Renewal  â”‚  â”‚  Storage        â”‚  â”‚  Generator      â”‚              â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜              â”‚
â”‚                                                                             â”‚
â”‚  HTTPS Proxy Rules:                                                         â”‚
â”‚  â€¢ frps.domain.com â†’ frps:8880 (HTTP Tunnel)                              â”‚
â”‚  â€¢ admin.domain.com â†’ frps:7001 (Dashboard)                               â”‚
â”‚  â€¢ mail.domain.com â†’ stalwart-mail:8080 (Web Admin)                       â”‚
â”‚                                                                             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                           â”‚              â”‚              â”‚
                           â”‚              â”‚              â”‚
                           â–¼              â–¼              â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚         FRPS Server         â”‚  â”‚   FRPS Admin    â”‚  â”‚    Stalwart Mail        â”‚
â”‚                             â”‚  â”‚   Dashboard     â”‚  â”‚       Server            â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                             â”‚  â”‚                 â”‚  â”‚                         â”‚
â”‚ Port 7000: Main Service     â”‚  â”‚ Port 7001: Web  â”‚  â”‚ Port 25: SMTP          â”‚
â”‚ Port 8880: HTTP Proxy       â”‚  â”‚ Management UI   â”‚  â”‚ Port 587: SMTP Submit  â”‚
â”‚ Port 8843: HTTPS Proxy      â”‚  â”‚                 â”‚  â”‚ Port 465: SMTP SSL     â”‚
â”‚                             â”‚  â”‚ Features:       â”‚  â”‚ Port 993: IMAP SSL     â”‚
â”‚ Features:                   â”‚  â”‚ â€¢ Tunnel Status â”‚  â”‚ Port 995: POP3 SSL     â”‚
â”‚ â€¢ TCP Multiplexing          â”‚  â”‚ â€¢ Client Config â”‚  â”‚ Port 4190: ManageSieve â”‚
â”‚ â€¢ Connection Pool           â”‚  â”‚ â€¢ Statistics    â”‚  â”‚ Port 8080: Web Admin   â”‚
â”‚ â€¢ Domain Routing            â”‚  â”‚ â€¢ User Mgmt     â”‚  â”‚                         â”‚
â”‚ â€¢ Load Balancing            â”‚  â”‚                 â”‚  â”‚ Features:               â”‚
â”‚                             â”‚  â”‚                 â”‚  â”‚ â€¢ Multi-domain Support â”‚
â”‚                             â”‚  â”‚                 â”‚  â”‚ â€¢ Anti-spam/Anti-virus â”‚
â”‚                             â”‚  â”‚                 â”‚  â”‚ â€¢ SSL/TLS Encryption   â”‚
â”‚                             â”‚  â”‚                 â”‚  â”‚ â€¢ Web-based Admin      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                           â”‚
                           â”‚
                           â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                        Client Connections                                   â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                             â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”              â”‚
â”‚  â”‚   FRPS Client   â”‚  â”‚  Email Client   â”‚  â”‚   Web Browser   â”‚              â”‚
â”‚  â”‚                 â”‚  â”‚                 â”‚  â”‚                 â”‚              â”‚
â”‚  â”‚ â€¢ Home Network  â”‚  â”‚ â€¢ Outlook       â”‚  â”‚ â€¢ Admin Panel   â”‚              â”‚
â”‚  â”‚ â€¢ Office LAN    â”‚  â”‚ â€¢ Thunderbird   â”‚  â”‚ â€¢ Tunnel Mgmt   â”‚              â”‚
â”‚  â”‚ â€¢ IoT Devices   â”‚  â”‚ â€¢ Mobile Mail   â”‚  â”‚ â€¢ Mail Webmail  â”‚              â”‚
â”‚  â”‚ â€¢ Servers       â”‚  â”‚ â€¢ Webmail       â”‚  â”‚                 â”‚              â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## ğŸ”„ æ•°æ®æµå‘å›¾

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    HTTPS     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    HTTP      â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                 â”‚ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¶â”‚                 â”‚ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¶â”‚                 â”‚
â”‚   Web Browser   â”‚              â”‚  Nginx Proxy    â”‚              â”‚  FRPS Server    â”‚
â”‚                 â”‚â—€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ â”‚                 â”‚â—€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ â”‚                 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜              â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜              â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                           â”‚
                                           â”‚ HTTP
                                           â–¼
                                  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                                  â”‚                 â”‚
                                  â”‚ Stalwart Mail   â”‚
                                  â”‚                 â”‚
                                  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     TCP      â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    Tunnel    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                 â”‚ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¶â”‚                 â”‚ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¶â”‚                 â”‚
â”‚  FRPS Client    â”‚              â”‚  FRPS Server    â”‚              â”‚ Internal Apps   â”‚
â”‚                 â”‚â—€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ â”‚                 â”‚â—€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ â”‚                 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜              â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜              â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   SMTP/IMAP  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                 â”‚ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¶â”‚                 â”‚
â”‚  Email Client   â”‚              â”‚ Stalwart Mail   â”‚
â”‚                 â”‚â—€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ â”‚                 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜              â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## ğŸš€ éƒ¨ç½²æµç¨‹å›¾

```
                            [å¼€å§‹éƒ¨ç½²]
                                 â”‚
                                 â–¼
                        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                        â”‚  æ£€æŸ¥ç³»ç»Ÿä¾èµ–    â”‚
                        â”‚ â€¢ Docker        â”‚
                        â”‚ â€¢ Docker Composeâ”‚
                        â”‚ â€¢ OpenSSL       â”‚
                        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                 â”‚
                                 â–¼
                        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                        â”‚  åˆå§‹åŒ–ç¯å¢ƒ      â”‚
                        â”‚ â€¢ åˆ›å»ºç›®å½•ç»“æ„   â”‚
                        â”‚ â€¢ ç”ŸæˆåŸºç¡€é…ç½®   â”‚
                        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                 â”‚
                                 â–¼
                        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                        â”‚ ç”ŸæˆæœåŠ¡é…ç½®     â”‚
                        â”‚ â€¢ FRPSé…ç½®      â”‚
                        â”‚ â€¢ Mailé…ç½®      â”‚
                        â”‚ â€¢ Nginxé…ç½®     â”‚
                        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                 â”‚
                                 â–¼
                        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                        â”‚  å¯åŠ¨åŸºç¡€æœåŠ¡    â”‚
                        â”‚ â€¢ Nginx         â”‚
                        â”‚ â€¢ FRPS          â”‚
                        â”‚ â€¢ Stalwart Mail â”‚
                        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                 â”‚
                                 â–¼
                        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                        â”‚  é…ç½®åŸŸåSSL     â”‚
                        â”‚ â€¢ ç”ŸæˆåŸŸåé…ç½®   â”‚
                        â”‚ â€¢ ç”³è¯·SSLè¯ä¹¦   â”‚
                        â”‚ â€¢ æ›´æ–°Nginxé…ç½® â”‚
                        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                 â”‚
                                 â–¼
                        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                        â”‚  é‡å¯æœåŠ¡åº”ç”¨    â”‚
                        â”‚  SSLé…ç½®        â”‚
                        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                 â”‚
                                 â–¼
                        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                        â”‚  éƒ¨ç½²å®Œæˆ        â”‚
                        â”‚ â€¢ æœåŠ¡éªŒè¯      â”‚
                        â”‚ â€¢ æ˜¾ç¤ºè®¿é—®ä¿¡æ¯   â”‚
                        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## ğŸ”§ ç«¯å£æ˜ å°„å›¾

```
                          ä¸»æœºç«¯å£              å®¹å™¨ç«¯å£
                       â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”      â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
Internet :80    â”€â”€â”€â”€â”€â”€ â”‚   80        â”‚ â”€â”€â”€â”€ â”‚   80        â”‚ Nginx
Internet :443   â”€â”€â”€â”€â”€â”€ â”‚   443       â”‚ â”€â”€â”€â”€ â”‚   443       â”‚ Nginx
                       â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜      â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

                       â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”      â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
FRPS Clients:7000 â”€â”€â”€â”€ â”‚   7000      â”‚ â”€â”€â”€â”€ â”‚   7000      â”‚ FRPS Server
Admin Panel :7001 â”€â”€â”€â”€ â”‚   7001      â”‚ â”€â”€â”€â”€ â”‚   7001      â”‚ FRPS Dashboard
                       â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜      â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

                       â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”      â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
SMTP        :25   â”€â”€â”€â”€ â”‚   25        â”‚ â”€â”€â”€â”€ â”‚   25        â”‚ Stalwart Mail
SMTP Submit :587  â”€â”€â”€â”€ â”‚   587       â”‚ â”€â”€â”€â”€ â”‚   587       â”‚ Stalwart Mail
SMTP SSL    :465  â”€â”€â”€â”€ â”‚   465       â”‚ â”€â”€â”€â”€ â”‚   465       â”‚ Stalwart Mail
IMAP SSL    :993  â”€â”€â”€â”€ â”‚   993       â”‚ â”€â”€â”€â”€ â”‚   993       â”‚ Stalwart Mail
POP3 SSL    :995  â”€â”€â”€â”€ â”‚   995       â”‚ â”€â”€â”€â”€ â”‚   995       â”‚ Stalwart Mail
ManageSieve :4190 â”€â”€â”€â”€ â”‚   4190      â”‚ â”€â”€â”€â”€ â”‚   4190      â”‚ Stalwart Mail
                       â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜      â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

å†…éƒ¨é€šä¿¡ç«¯å£ (ä»…å®¹å™¨é—´):
FRPS HTTP Proxy  : 8880
FRPS HTTPS Proxy : 8843
Mail Web Admin   : 8080
```

## ğŸ“ ç›®å½•ç»“æ„å›¾

```
frps-mail-ssl-deploy/
â”œâ”€â”€ ğŸ“„ deploy.sh                    # ä¸»éƒ¨ç½²è„šæœ¬
â”œâ”€â”€ ğŸ“„ docker-compose.yml           # Dockerç¼–æ’æ–‡ä»¶
â”œâ”€â”€ ğŸ“„ README.md                    # è¯¦ç»†æ–‡æ¡£
â”œâ”€â”€ ğŸ“„ architecture.md              # æ¶æ„è¯´æ˜(æœ¬æ–‡ä»¶)
â”‚
â”œâ”€â”€ ğŸ“ nginx/                       # Nginxé…ç½®
â”‚   â”œâ”€â”€ ğŸ“ conf/
â”‚   â”‚   â”œâ”€â”€ ğŸ“„ nginx.conf          # ä¸»é…ç½®
â”‚   â”‚   â””â”€â”€ ğŸ“ conf.d/             # åŸŸåé…ç½®ç›®å½•
â”‚   â”‚       â”œâ”€â”€ ğŸ“„ default.conf    # é»˜è®¤é…ç½®
â”‚   â”‚       â”œâ”€â”€ ğŸ“„ frps.domain.conf # FRPSåŸŸåé…ç½®
â”‚   â”‚       â”œâ”€â”€ ğŸ“„ admin.domain.conf# ç®¡ç†ç•Œé¢é…ç½®
â”‚   â”‚       â””â”€â”€ ğŸ“„ mail.domain.conf # é‚®ä»¶åŸŸåé…ç½®
â”‚   â””â”€â”€ ğŸ“ html/                   # Webæ ¹ç›®å½•
â”‚       â””â”€â”€ ğŸ“„ index.html          # æ¬¢è¿é¡µé¢
â”‚
â”œâ”€â”€ ğŸ“ frps/                       # FRPSé…ç½®
â”‚   â””â”€â”€ ğŸ“ config/
â”‚       â””â”€â”€ ğŸ“„ frps.toml           # FRPSæœåŠ¡å™¨é…ç½®
â”‚
â”œâ”€â”€ ğŸ“ stalwart-mail/              # é‚®ä»¶æœåŠ¡é…ç½®
â”‚   â”œâ”€â”€ ğŸ“ config/
â”‚   â”‚   â””â”€â”€ ğŸ“„ config.toml         # é‚®ä»¶æœåŠ¡å™¨é…ç½®
â”‚   â”œâ”€â”€ ğŸ“ data/                   # é‚®ä»¶æ•°æ®å­˜å‚¨
â”‚   â””â”€â”€ ğŸ“ logs/                   # é‚®ä»¶æœåŠ¡æ—¥å¿—
â”‚
â”œâ”€â”€ ğŸ“ certbot/                    # SSLè¯ä¹¦
â”‚   â””â”€â”€ ğŸ“ data/                   # Let's Encryptè¯ä¹¦å­˜å‚¨
â”‚       â””â”€â”€ ğŸ“ live/               # æ´»è·ƒè¯ä¹¦ç›®å½•
â”‚           â”œâ”€â”€ ğŸ“ domain1.com/    # åŸŸå1è¯ä¹¦
â”‚           â”œâ”€â”€ ğŸ“ domain2.com/    # åŸŸå2è¯ä¹¦
â”‚           â””â”€â”€ ğŸ“ domain3.com/    # åŸŸå3è¯ä¹¦
â”‚
â””â”€â”€ ğŸ“ logs/                       # ç³»ç»Ÿæ—¥å¿—
    â”œâ”€â”€ ğŸ“„ deploy.log              # éƒ¨ç½²æ—¥å¿—
    â”œâ”€â”€ ğŸ“„ ssl-renew.log           # è¯ä¹¦ç»­ç­¾æ—¥å¿—
    â”œâ”€â”€ ğŸ“ nginx/                  # Nginxæ—¥å¿—
    â”‚   â”œâ”€â”€ ğŸ“„ access.log          # è®¿é—®æ—¥å¿—
    â”‚   â”œâ”€â”€ ğŸ“„ error.log           # é”™è¯¯æ—¥å¿—
    â”‚   â”œâ”€â”€ ğŸ“„ domain1.access.log  # åŸŸå1è®¿é—®æ—¥å¿—
    â”‚   â””â”€â”€ ğŸ“„ domain1.error.log   # åŸŸå1é”™è¯¯æ—¥å¿—
    â””â”€â”€ ğŸ“ frps/                   # FRPSæ—¥å¿—
        â””â”€â”€ ğŸ“„ frps.log            # FRPSæœåŠ¡æ—¥å¿—
```

## ğŸ” SSLè¯ä¹¦ç®¡ç†æµç¨‹

```
                    [è¯ä¹¦ç”³è¯·æµç¨‹]
                          â”‚
                          â–¼
                 â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                 â”‚  æ£€æŸ¥åŸŸåè§£æ    â”‚
                 â”‚  Aè®°å½•æ˜¯å¦æŒ‡å‘   â”‚
                 â”‚  å½“å‰æœåŠ¡å™¨      â”‚
                 â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                          â”‚
                          â–¼
                 â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                 â”‚  å¯åŠ¨HTTPæœåŠ¡    â”‚
                 â”‚  ç”¨äºACMEéªŒè¯    â”‚
                 â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                          â”‚
                          â–¼
                 â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                 â”‚  è°ƒç”¨Certbot     â”‚
                 â”‚  ç”³è¯·è¯ä¹¦        â”‚
                 â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                          â”‚
                          â–¼
                 â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”      â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                 â”‚  éªŒè¯æˆåŠŸ        â”‚ â”€â”€â”€â”€ â”‚  è¯ä¹¦å­˜å‚¨åˆ°      â”‚
                 â”‚  è¯ä¹¦é¢å‘        â”‚      â”‚  certbot/data/  â”‚
                 â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜      â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                          â”‚
                          â–¼
                 â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                 â”‚  æ›´æ–°Nginxé…ç½®   â”‚
                 â”‚  å¯ç”¨HTTPS       â”‚
                 â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                          â”‚
                          â–¼
                 â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                 â”‚  é‡å¯Nginx       â”‚
                 â”‚  åº”ç”¨æ–°é…ç½®      â”‚
                 â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

                    [è‡ªåŠ¨ç»­ç­¾æµç¨‹]
                          â”‚
                          â–¼
                 â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                 â”‚  Cronä»»åŠ¡è§¦å‘    â”‚
                 â”‚  (æ¯å‘¨æ—¥2ç‚¹)     â”‚
                 â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                          â”‚
                          â–¼
                 â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                 â”‚  æ£€æŸ¥è¯ä¹¦åˆ°æœŸ    â”‚
                 â”‚  æ—¶é—´(<30å¤©)     â”‚
                 â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                          â”‚
                          â–¼
                 â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                 â”‚  è‡ªåŠ¨ç»­ç­¾è¯ä¹¦    â”‚
                 â”‚  æ— éœ€åœæœº        â”‚
                 â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                          â”‚
                          â–¼
                 â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                 â”‚  é‡æ–°åŠ è½½Nginx   â”‚
                 â”‚  åº”ç”¨æ–°è¯ä¹¦      â”‚
                 â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## ğŸŒ ç½‘ç»œæ‹“æ‰‘å›¾

```
                              Internet
                                 â”‚
                                 â”‚
                          â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                          â”‚   Firewall  â”‚
                          â”‚   Port 80   â”‚
                          â”‚   Port 443  â”‚
                          â”‚   Port 25   â”‚
                          â”‚   Port 587  â”‚
                          â”‚   Port 465  â”‚
                          â”‚   Port 993  â”‚
                          â”‚   Port 995  â”‚
                          â”‚   Port 4190 â”‚
                          â”‚   Port 7000 â”‚
                          â”‚   Port 7001 â”‚
                          â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                 â”‚
                                 â”‚
                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                    â”‚        Docker Host          â”‚
                    â”‚                             â”‚
                    â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
                    â”‚  â”‚   Docker Network      â”‚  â”‚
                    â”‚  â”‚   (app-network)       â”‚  â”‚
                    â”‚  â”‚   172.20.0.0/16       â”‚  â”‚
                    â”‚  â”‚                       â”‚  â”‚
                    â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â” â”‚  â”‚
                    â”‚  â”‚  â”‚Nginxâ”‚ â”‚FRPS â”‚ â”‚Mailâ”‚ â”‚  â”‚
                    â”‚  â”‚  â”‚Proxyâ”‚ â”‚Serverâ”‚ â”‚Srvrâ”‚ â”‚  â”‚
                    â”‚  â”‚  â””â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”˜ â”‚  â”‚
                    â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
                    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## ğŸ“Š ç›‘æ§è§†å›¾

```
                        [ç³»ç»Ÿç›‘æ§é¢æ¿]
                               â”‚
           â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
           â”‚                   â”‚                   â”‚
           â–¼                   â–¼                   â–¼
  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
  â”‚   æœåŠ¡çŠ¶æ€       â”‚ â”‚   SSLè¯ä¹¦       â”‚ â”‚   æ€§èƒ½æŒ‡æ ‡      â”‚
  â”‚                â”‚ â”‚                 â”‚ â”‚                 â”‚
  â”‚ âœ… Nginx: è¿è¡Œ   â”‚ â”‚ ğŸ”’ domain1.com  â”‚ â”‚ ğŸ“ˆ CPU: 15%     â”‚
  â”‚ âœ… FRPS: è¿è¡Œ    â”‚ â”‚    90å¤©æœ‰æ•ˆ     â”‚ â”‚ ğŸ’¾ å†…å­˜: 1.2GB  â”‚
  â”‚ âœ… Mail: è¿è¡Œ    â”‚ â”‚ ğŸ”’ domain2.com  â”‚ â”‚ ğŸ’¿ ç£ç›˜: 45%    â”‚
  â”‚                â”‚ â”‚    85å¤©æœ‰æ•ˆ     â”‚ â”‚ ğŸŒ ç½‘ç»œ: æ­£å¸¸   â”‚
  â”‚ ğŸ”„ è‡ªåŠ¨ç»­ç­¾: å¼€å¯ â”‚ â”‚ ğŸ”’ domain3.com  â”‚ â”‚ ğŸ“§ é‚®ä»¶: 12å°   â”‚
  â”‚                â”‚ â”‚    92å¤©æœ‰æ•ˆ     â”‚ â”‚ ğŸš€ éš§é“: 3ä¸ª    â”‚
  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
           â”‚                   â”‚                   â”‚
           â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                               â”‚
                               â–¼
                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                    â”‚   å‘Šè­¦é€šçŸ¥       â”‚
                    â”‚                â”‚
                    â”‚ ğŸ“§ é‚®ä»¶é€šçŸ¥      â”‚
                    â”‚ ğŸ“± çŸ­ä¿¡å‘Šè­¦      â”‚
                    â”‚ ğŸ”” ç³»ç»Ÿæ—¥å¿—      â”‚
                    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

è¿™ä¸ªæ¶æ„å›¾è¯¦ç»†å±•ç¤ºäº†æ•´ä¸ªç³»ç»Ÿçš„ç»„ä»¶å…³ç³»ã€æ•°æ®æµå‘ã€éƒ¨ç½²æµç¨‹å’Œç›‘æ§æ–¹æ¡ˆï¼Œè®©éƒ¨ç½²å’Œè¿ç»´æ›´åŠ æ¸…æ™°æ˜äº†ï¼